* [English](README.md)
* Russian :point_left:

# Описание архитектуры для приложения "XIAG Polls"

## Планируется следующая архитектура на уровне компонентов:
* На backend использование связки php-fpm+Twig+MySQL+nginx;
* Для frontend - React, сборка webpack'ом;
* Необходимые пакеты/библиотеки для PHP и JS установить соответственно через composer и yarn;
* На уровне nginx предусмотреть наличие кэширования ответов, что бы снизить нагрузку на backend в случае DoS атаки;
* Компоненты следует запускать в [docker](https://docs.docker.com/install/) контейнерах, взаимодействие компонентов следует описать в виде [docker-compose](https://docs.docker.com/compose/install/) файла, для воспроизводимости при переносе в другое окружение.

## Архитектуру на уровне приложения планируется реализовать следующим образом:
* Разметку форм ввода данных взять из образцов:
    * [форма создания нового голосования](https://test-task.xiag.ch/fullstack-developer__example1.html)
    * [форма ввода ответа (с выводом результатов)](https://test-task.xiag.ch/fullstack-developer__example2.html)
* После ввода корректных параметров нового опроса - данные от клиента отправляются на сервер;
* На сервере, если данные корректны, в таблицу "Poll" помещается запись об опросе, в таблицу "Answers" - варианты ответы, с привязкой к опросу.
Сервер отправляет ответ с идентификатором (uid), и, опционально, адресом - для направления клиента на страницу голосования;
* При получении серверного ответа, в браузере происходит переход на страницу голосования. Возможно, при переходе на эту страницу имеет смысл получить согласие пользователя на установку cookie;
* После заполнения пользователем обязательного поля и выбора ответа данные формы отправляются на сервер. Кстати, в условиях не указано, что ответ должен быть обязательно выбран, но, т.к. само понятие "голосование" подразумевает обязательный выбор одного из вариантов, то разработчик предлагает сделать обязательным выбор одного из ответов, о чем на этапе планирования архитектуры предупреждает постановщика задачи;
* Перед отправкой формы необходимо проверить наличие установленной cookie, говорящей о том что ответ пользователем ранее уже успешно отправлялся. Данная проверка нужна на тот случай если по уникальной ссылке голосования пользователь зайдёт сразу в нескольких вкладок в браузере и попробует голосовать в них по очереди;
* На странице голосования в нижней части выводится таблица с ответами, которые дали другие пользователи. Данные в таблице обновляются по таймеру;
* Сервер при получении данных от формы голосования сохраняет данные в БД, и в ответе клиенту возвращает все имеющиеся по текущему голосованию ответы;
* Клиентская часть, при удачном получении серверного ответа, устанавливает cookie со значением идентификатора опроса, для отметки о том что клиент прошел голосование. Таблица результатов внизу страницы обновляется в соответствии с полученными от сервера последними данными о голосовании.